<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ZdryYwspb">
	<typeAlias alias="zdryYwspb" type="com.founder.zdry.bean.ZdryYwspb" />
	<typeAlias alias="zdryYwspbvo" type="com.founder.zdry.vo.ZdryYwspbVo" />
	<insert id="save" parameterClass="zdryYwspb">
		 <![CDATA[ INSERT INTO ZDRY_YWSPB
		 	(ID,YWBM,YWBID,SQR_XM,SQR_ID,SQSJ,SPR_XM,SPR_ID,SPSJ,SPJG,SPYJ,BZ,SPBM,SQYJ, ]]>
		<include refid="insertXtzd" /><![CDATA[ ) 
		 values 
		 	(#id#,#ywbm#,#ywbid#,#sqr_xm#,#sqr_id#,#sqsj#,#spr_xm#,#spr_id#,#spsj#,#spjg#,#spyj#,#bz#,#spbm#,#sqyj#, ]]>
		<include refid="insertXtzdVal" /><![CDATA[ 
			)]]>
	</insert>


	<!-- 查询单条记录 -->
	<select id="queryById" parameterClass="String" resultClass="zdryYwspb">
		<![CDATA[ select * from ZDRY_YWSPB where id = #id#]]>
	</select>

	<!-- 更新 -->
	<update id="updateZdryYwspb" parameterClass="zdryYwspb">
	 <![CDATA[ update ZDRY_YWSPB ]]>
		<dynamic prepend="set">
			<isNotNull prepend="," property="id"><![CDATA[ ID=#id# ]]></isNotNull>
			<isNotNull prepend="," property="ywbm"><![CDATA[ YWBM=#ywbm# ]]></isNotNull>
			<isNotNull prepend="," property="ywbid"><![CDATA[ YWBID=#ywbid# ]]></isNotNull>
			<isNotNull prepend="," property="sqr_xm"><![CDATA[ SQR_XM=#sqr_xm# ]]></isNotNull>
			<isNotNull prepend="," property="sqr_id"><![CDATA[ SQR_ID=#sqr_id# ]]></isNotNull>
			<isNotNull prepend="," property="sqsj"><![CDATA[ SQSJ=#sqsj# ]]></isNotNull>
			<isNotNull prepend="," property="spr_xm"><![CDATA[ SPR_XM=#spr_xm# ]]></isNotNull>
			<isNotNull prepend="," property="spr_id"><![CDATA[ SPR_ID=#spr_id# ]]></isNotNull>
			<isNotNull prepend="," property="spsj"><![CDATA[ SPSJ=#spsj# ]]></isNotNull>
			<isNotNull prepend="," property="spjg"><![CDATA[ SPJG=#spjg# ]]></isNotNull>
			<isNotNull prepend="," property="spyj"><![CDATA[ SPYJ=#spyj# ]]></isNotNull>
			<isNotNull prepend="," property="bz"><![CDATA[ BZ=#bz# ]]></isNotNull>
			<isNotNull prepend="," property="spbm"><![CDATA[ spbm=#spbm# ]]></isNotNull>
			<isNotNull prepend="," property="sqyj"><![CDATA[ sqyj=#sqyj# ]]></isNotNull>
			
			,
			<include refid="updateXtzd" />
		</dynamic>
	 <![CDATA[ where id = #id#]]>
	</update>

	<!-- 通用查询，根据对象查询LIST -->
	<select id="query" parameterClass="zdryYwspb" resultClass="zdryYwspb">
		<![CDATA[select * from ZDRY_YWSPB t  where  XT_ZXBZ = '0' ]]>
		<isNotNull prepend="AND" property="id"><![CDATA[ ID=#id# ]]></isNotNull>
		<isNotNull prepend="AND" property="ywbm"><![CDATA[ YWBM=#ywbm# ]]></isNotNull>
		<isNotNull prepend="AND" property="ywbid"><![CDATA[ YWBID=#ywbid# ]]></isNotNull>
		<isNotNull prepend="AND" property="sqr_xm"><![CDATA[ SQR_XM=#sqr_xm# ]]></isNotNull>
		<isNotNull prepend="AND" property="sqr_id"><![CDATA[ SQR_ID=#sqr_id# ]]></isNotNull>
		<isNotNull prepend="AND" property="sqsj"><![CDATA[ SQSJ=#sqsj# ]]></isNotNull>
		<isNotNull prepend="AND" property="spr_xm"><![CDATA[ SPR_XM=#spr_xm# ]]></isNotNull>
		<isNotNull prepend="AND" property="spr_id"><![CDATA[ SPR_ID=#spr_id# ]]></isNotNull>
		<isNotNull prepend="AND" property="spsj"><![CDATA[ SPSJ=#spsj# ]]></isNotNull>
		<isNotNull prepend="AND" property="spjg"><![CDATA[ SPJG=#spjg# ]]></isNotNull>
		<isNotNull prepend="AND" property="spyj"><![CDATA[ SPYJ=#spyj# ]]></isNotNull>
		<isNotNull prepend="AND" property="bz"><![CDATA[ BZ=#bz# ]]></isNotNull>
		<isNotNull prepend="AND" property="spbm"><![CDATA[ spbm=#spbm# ]]></isNotNull>
		 <![CDATA[ order by XT_ZHXGSJ desc]]>
	</select>
	
	<!-- 查询列表 -->
	<select id="queryListCount" parameterClass="Map" resultClass="Integer">
		<![CDATA[ select count(1) from ZDRY_YWSPB a,zdry_lczywblb b where a.ywbid=b.id and a.XT_ZXBZ = '0'   ]]>
		<isNotEmpty prepend="and" property="zdryYwspbVo.spbm">
			(a.spbm =#zdryYwspbVo.spbm#
		</isNotEmpty>
		<isNotEmpty prepend="or" property="zdryYwspbVo.spr_id">
			a.SPR_ID =#zdryYwspbVo.spr_id#)
		</isNotEmpty>
		<isNotEmpty prepend="and" property="zdryYwspbVo.ywlx">
			b.ywlx =#zdryYwspbVo.ywlx#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="zdryYwspbVo.kssj">
			<![CDATA[a.spsj >#zdryYwspbVo.kssj#]]>
		</isNotEmpty>
		<isNotEmpty prepend="and" property="zdryYwspbVo.jssj">
			<![CDATA[a.spsj <#zdryYwspbVo.jssj#]]>
		</isNotEmpty>
		<isEqual property="zdryYwspbVo.sfsp" compareValue="0" prepend="AND">
		     	<![CDATA[ a.spjg is null ]]>
		</isEqual>
		<isEqual property="zdryYwspbVo.sfsp" compareValue="1" prepend="AND">
		     	<![CDATA[  a.spjg is not null]]>
		</isEqual>
	</select>
	<select id="queryList" parameterClass="Map" resultClass="zdryYwspbvo">
		<![CDATA[ select * from ( select rownum r ,m.* from (
			 select  a.sqr_xm,a.sqyj,a.spjg,b.ywlx,a.ywbid,a.id,a.sqsj from ZDRY_YWSPB a,zdry_lczywblb b where a.ywbid=b.id and a.XT_ZXBZ = '0'    ]]>
		<isNotEmpty prepend="and" property="zdryYwspbVo.spbm">
			(a.spbm =#zdryYwspbVo.spbm#
		</isNotEmpty>
		<isNotEmpty prepend="or" property="zdryYwspbVo.spr_id">
			a.SPR_ID =#zdryYwspbVo.spr_id#)
		</isNotEmpty>
		<isNotEmpty prepend="and" property="zdryYwspbVo.ywlx">
			b.ywlx =#zdryYwspbVo.ywlx#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="zdryYwspbVo.kssj">
			<![CDATA[a.spsj >#zdryYwspbVo.kssj#]]>
		</isNotEmpty>
		<isNotEmpty prepend="and" property="zdryYwspbVo.jssj">
			<![CDATA[a.spsj <#zdryYwspbVo.jssj#]]>
		</isNotEmpty>
		<isEqual property="zdryYwspbVo.sfsp" compareValue="0" prepend="AND">
		     	<![CDATA[ a.spjg is null ]]>
		</isEqual>
		<isEqual property="zdryYwspbVo.sfsp" compareValue="1" prepend="AND">
		     	<![CDATA[  a.spjg is not null]]>
		</isEqual>
			<![CDATA[ order by $sort$ $order$) m  
		where rownum <= #end# ) where r > #begin# ]]>
	</select>
</sqlMap>